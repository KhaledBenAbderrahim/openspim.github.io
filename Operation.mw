Now that we have assembled the OpenSPIM microscope it is time to start using it. We will need to prepare a sample, align the light sheet (Calibration), set-up the acquisition and process the data.

= Sample Preparation =

The basic principles of sample preparation for SPIM differs from traditional microscopy technologies. There are no glass slides and coverslips. Instead the sample needs to be suspended in a water filled chamber in front of the lens so that it can be rotated. This is usually achieved by embedding the sample in a low melting point (LMP) agarose inside a glass capillary equipped with a plunger. For imaging the agarose column with the specimen is pushed out of the capillary using the plunger to hang in front of the lens.

There are many other strategies to mount SPIM samples using FEP tubes, hooks or agarose baskets.

For the purpose of making registration easier, we mix the sub-resolution fluorescent beads into the specimen containing agarose slurry and use them as fiduciary markers to align the different SPIM views. The software to do that is available in [http://fiji.sc Fiji]. 

Preparation of  [[Drosophila embryo sample preparation|Drosophila embryos]] for SPIM imaging.

= Calibration =

Before using the OpenSPIM the light sheet needs to be  [[Light-sheet Calibration|aligned]]. It means that the light sheet needs to be shaped by the optics of the system to be parallel to the imaging plane of the camera, perpendicular to the detection axis, as thin as possible, uniform across the field of view and most importantly in focus with the detection objective. Since the procedure is rather involved we provide a series of detailed videos that illustrate the process. Innovations are welcome.

Although once aligned the light sheet is rather stable it should be [[Light-sheet Calibration|aligned]] in regular intervals or whenever the image quality or point spread function of the beads looks suboptimal.

We also recommend to examine the signal in the imaged specimen and tweak the light sheet using the bottom knob on the lower left corner mirror of the set-up to optimize the image quality. The knob moves the light sheet roughly parallel to the focal plane of the detection lens and thus moving it back an forth one focuses the lens into the middle of the light sheet.

[[Category:Hardware]]

= Software =

Please make sure that you have [[Downloads#Initial_hardware_configuration|configured the hardware]] properly before trying to acquire images.

[[Image:Stagecontrols.png|480px|right]]

== Stage Control ==

Controlling the stage is accomplished primarily through µManager's live window: after [[Pixel Size Calibration|a pixel size has been provided]], the user can simply click and drag across the display to change the view accordingly. The scroll wheel is used for depth/focus movement. The OpenSPIM software provides an additional dimension of control in the rotational motor: holding the Alt key while moving the mouse side-to-side will cause the sample to be rotated about a previously-determined axis.

Alternatively, the stage controls tab of the OpenSPIM plugin can be used to move to specific locations.

== Acquisition ==

Acquisition is handled primarily through the appropriately-named Acquisition tab.

=== Acquiring a Single Image ===

To acquire a single image using the OpenSPIM plugin, navigate the 4D stage to the location you want to image. Beneath the "Stack at this Z plus:" button are two spinners: the left spinner controls the stack depth (in motor steps), and the right controls the step size (also in motor steps). Set the stack depth (the first box) to 0 and click "Stack at this Z plus:" to add the location to the positions list. (Of course, µManager provides its own single-image recording in the form of the Snap button on the live window.)

Once you've added the location of the image you wish to take, you can specify an output directory (if you would prefer the image go straight to an OME-TIFF, rather than be opened in Fiji). Finally, click ''Oh Snap!'' to take the image. (The various options for acquisition have no effect on single planes, with the exception of "Snap Continuously" which should not be checked. For a description of the various options, see [[#Acquisition Options|Acquisition Options]].)

[[Image:Spimgui acquiring.png|480px|left]] 
=== Acquiring a Stack ===

Acquiring a single stack is very similar to acquiring a single position, beginning by navigating to the place the stack should begin. Specify the depth of the stack in motor steps in the left spinner and the number of motor steps between each slice in the right spinner, then click "Stack at this Z plus:" to add the stack to the positions list. 

=== Single-Plane Time Lapse ===

To acquire a time lapse of a single plane, set up the recording exactly as if you were going to record only one image. Then enable the Time box and specify a delay (0 seconds is allowed) and a repetition count. Once these options are set, and optionally after specifying an output directory, click ''Oh Snap!'' to begin.

=== Multi-View Imaging of a Fixed Sample ===

To record multiple views of a fixed sample, the user navigates the 4D stage to each view they wish to record and marks that location, specifying the depth and step size of the stack (as appropriate). After choosing an output directory, click ''Oh Snap!'' to begin the multi-view imaging.

=== Multi-View Time Lapses ===

The acquisition tab makes recording a time lapse of any number of views simple: Simply set up a multi-view acquisition as described above, then after choosing any desired options (i.e. enabling anti-drift or continuous acquisition) and specifying a directory in which to save the acquired OME images, a checkbox will enable the time-lapse controls. There, the user specifies a desired interval between the beginning of each series, and the number of series to acquire. Once everything is set up, clicking ''Oh Snap!'' will begin the acquisition.

=== Acquisition Options ===

;Set z-stage velocity
:This option can control the speed of the focus motor, to allow for more careful positioning at the expense of additional time for the motor to move.
;Z settle time (ms)
:Specifying a time interval here will cause each movement of the stage to be followed by the given delay, to prevent jitter. This will also add time to acquisitions.
;Snap Continuously
:Rather than take precisely one image each time the motor reaches a position (either in the list, or at a slice within a stack), if this is checked the camera will record images constantly while the stage moves. (In between time-points, the acquisition will stop.) This can cause blurry images, however, since the stage is often moving while the camera exposes.
;Use Anti-Drift
:In long-term, multi-view time lapses, a common problem is the shrinking of the agarose column containing the sample. Enabling this option will activate interactive anti-drift, to combat this. See [[Anti-Drift]].
;Update Live View
:If enabled, every time the camera takes an image it will update the live window. This can make identifying a shifting sample easy, but may also increase acquisition time.
;Lase Full Stack
:By default, the laser will blink for each slice in a stack. Enabling this will cause the laser to remain on for the entire stack, then turn off in between time points. This speeds up acquisition, but can cause bleaching.
;Output directory
:If a directory is given, the acquired images will be written out as an OME-TIFF dataset. Otherwise, the images will be stored in memory and opened in Fiji after acquisition. Outside of testing acquisition, it is strongly recommended that an output directory be specified.
;Asynchronous Output
:Rather than writing out each slice as soon as it is taken, if this is checked the images will be buffered and written out as soon as the program finds time. This can greatly speed up acquisition, but if an acquisition fails or is aborted, the metadata in the stored images will be inconsistent.
;Time
:If the checkbox is enabled, a time-lapse will be recorded.
:;Interval
::The number of seconds between the ideal start of each time lapse. If acquiring a sequence (the entire positions list) takes less time than this interval, the system will wait until the remaining time has elapsed.
:;Count
::The number of sequences to record. Each sequence will record the entire positions list.
;Device Timeout
:If specified, this will override µManager's default timeout (5 seconds). It should only be enabled if you encounter "device timeout" errors (i.e. if the stage has to move a long distance, but its velocity is too low to cover that distance in five seconds).

[[Category:Operation]]

== Data processing ==

Preprocessing of OpenSPIM ome.tiff stacks for multi-view reconstruction.

Registration of multi-view OpenSPIM acquisition using bead based registration pluign in Fiji.

Fusion of registered multi-view OpenSPIM data into s a single output image using content based fusion or multi-view deconvolution.

Processing of long-term time lapse data.

Viewing the registered fused data and rendering of movies using Fiji's 3D viewer.

Tips and tricks.

[[Category:Software]]
